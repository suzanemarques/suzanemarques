<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="jquery-3.6.0.min.js" ></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" 
    integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        html {

            font-family: Arial, Helvetica, sans-serif;
        }

        body {
            padding: 40px;
        }

        table {
            border: solid 1px black;
            border-collapse: collapse;
            border-spacing: 0;
            width:100%;
    

        }

        th,
        td {
            border: solid 1px black;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div>
        <h1>AGENDA 2021</h1> 
        <form>
            <br>
    </div>
    <div style="width:40%"> 
        <div class="form-group">
            <label for="nome">Nome:</label>
            <input class="form-control" type="text" nome="Nome"  id="nome" 
            data-is-module="charCounter" minlength="5" maxlength="60" placeholder="Digite Nome e Sobrenome" required><br>
         </div>
        <div class="form-group">
            <label for="nome">Idade:</label>
            <input class="form-control" type="text" nome="idade" id="idade" 
            data-is-module="charCounter" minlength="1" maxlength="120" placeholder="Digite sua Idade" required><br>
        </div>
        <div class="form-group">
            <label for="nome">Telefone:</label>
            <input class="form-control sp_celphones" type="text" id="telefone"
            data-is-module="charCounter" maxlength="14" name="telefone" placeholder="00 00000-0000"><br>
             </div>
        <div class="form-group">
            <label for="nome">Endereço:</label>
            <input class="form-control" type="text" nome="endereco" id="endereco" 
            data-is-module="charCounter" minlength="10" maxlength="120" placeholder="Digite o seu Endereço" required><br>
        </div>
        <div class="form-group">
            <label for="nome">Bairro:</label>
            <input class="form-control"type="text" nome="bairro" id="bairro"
            data-is-module="charCounter" minlength="10" maxlength="40" placeholder="Digite o seu Bairro" required><br>
        </div>
        <div class="form-group">
            <label for="nome">Cidade:</label>
            <input class="form-control"type="text" nome="cidade" id="cidade" 
            required data-is-module="charCounter" minlength="10" maxlength="40"
             placeholder="Digite o nome da Cidade" required><br>
            
        </div>
    </form>
    <br>
    <div class="row">
        <div class="col-md-2">
            <button type="button" class="btn btn-success" onmouseout="removeClass(this)" 
            onmouseover="mudarClasseBotao(this)" onclick="salvar()">Salvar</button>
            <br>
        </div>
    </div>
    <br>
    
    <table id= "dados" >
        <head>
        <tr>
            <th>Nome</th>
            <th>Idade</th>
            <th>Telefone</th>
            <th>Endereço</th>
            <th>Bairro</th>
            <th>Cidade</th>
        </tr>
        </head>
    </table>
    <script>     

    $(function(){
        var SPMaskBehavior = function (val) {
        return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
        },
        spOptions = {
        onKeyPress: function(val, e, field, options) {
            field.mask(SPMaskBehavior.apply({}, arguments), options);
            }
        };

        $('.sp_celphones').mask(SPMaskBehavior, spOptions);
        
    
        function mascaraDeTelefone(telefone) {
            const textoAtual=telefone.value;
        }

        function removeClass(element){
            element.classList.remove("btn-danger");
        }

        function mudarClasseBotao(element){
            element.classList.add("btn-danger");
        }

        function createDOMElement(str) {
            let temp = document.createElement('template');
            temp.innerHTML = str.trim();
            return temp;
        }
    
        function salvar(nome, idade, telefone, endereco, bairro, cidade){
            try{

                var linhaNova = createDOMElement(`
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                `);

                setDadosCellValue("nome", linhaNova);
                setDadosCellValue("idade", linhaNova);
                setDadosCellValue("telefone", linhaNova);
                setDadosCellValue("endereco", linhaNova);
                setDadosCellValue("bairro", linhaNova);
                setDadosCellValue("cidade", linhaNova);

                let content = document.getElementById("dados").innerHTML;

                document.getElementById("dados").innerHTML = content + linhaNova.innerHTML;

                

                limparCampos();

            }
            catch(error){
                alert(error);
            }
        }

        function limparCampos(){
            //document.getElementById('nome').value = ''; JavaScript puro ou Vanilla
            $("#nome").val(''); // Jquery

            document.getElementById('idade').value = '';
            document.getElementById('telefone').value = '';
            document.getElementById('endereco').value = '';
            document.getElementById('bairro').value = '';
            document.getElementById('cidade').value = '';
        }
        
        const validacoes = {
            nome: validaNome, 
            idade: validaIdade,
            telefone: validaTelefone,
            endereco: validaEndereco,
            bairro: validaBairro,
            cidade: validaCidade,

        };
        // () => console.log('teste'); // função lambda.
        function validaNome(value){
            if(value == '')
                return "O campo nome é obrigatório";

            if(value.length < 5 || value.length > 60)
                return "O campo nome precisa ter de 5 a 60 caractéres.";
        }
        function validaIdade(value){
            if(value == '')
            return "O campo idade é obrigatório";            

            if(parseInt(value) < 1 || parseInt(value) > 120)
            return "A idade precisar estar entre 1 e 120"
        }
        function validaTelefone(value){
            if(value == '')
                return "O campo telefone é obrigatório";

            if(!value.match(/^[0-9]{2}[ ][0-9]{5}[-][0-9]{4}$/))
                return "Insira um telefone válido.";
        }
        function validaEndereco(value){
            if(value == '')
            return "O campo endereco é obrigatório";

            if(value.length > 120)
                return "O campo endereco precisa ter no máximo 120 caractéres.";
        }
        function validaBairro(value){
            if(value == '')
                return "O campo bairro é obrigatório";

            if(value.length > 40)
                return "O campo bairro precisa ter maximo 40 caractéres.";
        }
        function validaCidade(value){
            if(value == '')
                return "O campo cidade é obrigatório";

            if(value.length > 40)
                return "O campo cidade precisa ter maximo 40 caractéres.";

        }


              
        function setDadosCellValue(name, linhaNova){

            var error = validacoes[name] && validacoes[name](getFieldValue(name));
            
            if(error){
                throw Error(error);
            }

            var campos = ["nome", "idade", "telefone", "endereco", "bairro", "cidade"];

            var cellIndex = campos.indexOf(name);

            setCellValue(linhaNova, cellIndex, getFieldValue(name));
        }

        function getFieldValue(name){
            return document.getElementById(name).value;
        }

        function setCellValue(linhaNova, cellIndex, value){
            linhaNova.content.firstChild.getElementsByTagName('td')[cellIndex].innerText = value;



        }   


        function tiraHifen(telefone) {
            const textoAtual=telefone.value;
            const textoAjustado=textoAtual.replace(/\-/g,);

            telefone.value=textoAjustado;
        }

        

        /*
            validação
            a aparencia dos campos

                nome: min: 5, max 60, required
                idade: min 0, max 120, required
                telefone: formato 00 00000-0000
                endereço: max characteres 120, required
                bairro: max characteres 40, required
                cidade: max characteres 40, required
        */
    });
    </script>
    
</body>

</html>